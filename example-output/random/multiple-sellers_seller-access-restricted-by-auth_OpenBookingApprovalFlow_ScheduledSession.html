<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
</head>
<body>
<p><head>
  </p>
<style>
h2 {
    cursor: pointer;
    border-top-color: #CCC;
    border-top-width: 1px;
    border-top-style: solid;
    padding-top: 5px;
}
h2:hover {
    color: #0056b3; /* Example color change on hover */
}
</style>
<p></head></p>
<p><a href="summary.html" rel="noopener noreferrer" target="_blank">< Return to Summary</a> | File Generated: Thu Apr 17 2025 12:14:28 GMT+0000 (Coordinated Universal Time)</p>
<p><button id="collapseH2Button">Collapse All Sections</button>
<button id="showH2Button">Show All Sections</button>
<button id="collapseAllButFirstError">Show Only First Error</button></p>
<h1 id="multiplesellersselleraccessrestrictedbyauthopenbookingapprovalflowscheduledsession">multiple-sellers &gt;&gt; seller-access-restricted-by-auth (OpenBookingApprovalFlow &gt;&gt; ScheduledSession)</h1>
<p><strong>Booking Flow:</strong> OpenBookingApprovalFlow</p>
<p><strong>Opportunity Type:</strong> ScheduledSession</p>
<p><strong>Feature:</strong> Core / Multiple Sellers (Implemented) </p>
<p><strong>Test:</strong>  Credentials for Seller (a) must not provide access to make bookings for Seller (b)</p>
<p>Using primary seller auth, make a call to C1, C2, and P/B for the secondary seller, expecting all calls to fail with InvalidAuthorizationDetailsError</p>
<h3 id="runningonlythistest">Running only this test</h3>
<pre><code class="bash language-bash">npm start -- --runInBand test/features/core/multiple-sellers/implemented/seller-access-restricted-by-auth-test.js
</code></pre>
<h3 id="isthistestfailing">Is this test failing?</h3>
<p>The <a href="https://openactive.io/openactive-test-suite/example-output/random/multiple-sellers_seller-access-restricted-by-auth_OpenBookingApprovalFlow_ScheduledSession.html" rel="noopener noreferrer" target="_blank">OpenActive Reference Implementation test result for this test</a> can be used as a reference to help with debugging.</p>
<hr />
<p>‚ö†Ô∏è 8 passed with 0 failures, 33 warnings and 18 suggestions </p>
<hr />
<h2 id="fetchopportunities">‚úÖ Fetch Opportunities</h2>
<h3 id="localmicroservicetestinterfacefororderitem0request">Local Microservice Test Interface for OrderItem 0 Request</h3>
<p>POST http://localhost:3000/test-interface/datasets/uat-ci/opportunities</p>
<pre><code class="json language-json">{
  "@type": "ScheduledSession",
  "superEvent": {
    "@type": "SessionSeries",
    "organizer": {
      "@type": "Organization",
      "@id": "https://localhost:5001/api/identifiers/sellers/2"
    }
  },
  "@context": [
    "https://openactive.io/",
    "https://openactive.io/test-interface"
  ],
  "test:testOpportunityCriteria": "https://openactive.io/test-interface#TestOpportunityBookable",
  "test:testOpenBookingFlow": "https://openactive.io/test-interface#OpenBookingApprovalFlow"
}
</code></pre>
<hr />
<p>Response status code: 200 OK. Responded in 13.72424ms.</p>
<pre><code class="json language-json">{
  "@context": "https://openactive.io/",
  "@type": "ScheduledSession",
  "@id": "https://localhost:5001/api/identifiers/scheduled-sessions/1125/events/11250"
}
</code></pre>
<h3 id="opportunityfeedextractfororderitem0request">Opportunity Feed extract for OrderItem 0 Request</h3>
<p>GET http://localhost:3000/opportunity/https%3A%2F%2Flocalhost%3A5001%2Fapi%2Fidentifiers%2Fscheduled-sessions%2F1125%2Fevents%2F11250?useCacheIfAvailable=true</p>
<hr />
<p>Response status code: 200 OK. Responded in 6.852813ms.</p>
<pre><code class="json language-json">{
  "data": {
    "@context": [
      "https://openactive.io/"
    ],
    "@type": "ScheduledSession",
    "@id": "https://localhost:5001/api/identifiers/scheduled-sessions/1125/events/11250",
    "startDate": "2025-04-26T18:59:25+00:00",
    "endDate": "2025-04-27T00:06:25+00:00",
    "superEvent": {
      "@type": "SessionSeries",
      "@id": "https://localhost:5001/api/identifiers/session-series/1125",
      "identifier": 1125,
      "name": "Granite Walking",
      "activity": [
        {
          "@type": "Concept",
          "@id": "https://openactive.io/activity-list#95092977-5a20-4d6e-b312-8fddabe71544",
          "inScheme": "https://openactive.io/activity-list",
          "prefLabel": "Walking"
        }
      ],
      "eventAttendanceMode": "https://schema.org/MixedEventAttendanceMode",
      "location": {
        "@type": "Place",
        "@id": "https://example.com/place/1",
        "identifier": 1,
        "name": "Post-ercise Plaza",
        "description": "Sorting Out Your Fitness One Parcel Lift at a Time! Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
        "address": {
          "@type": "PostalAddress",
          "addressCountry": "GB",
          "addressLocality": "Oxford",
          "addressRegion": "Oxfordshire",
          "postalCode": "OX1 1AA",
          "streetAddress": "Kings Mead House"
        },
        "amenityFeature": [
          {
            "@type": "ChangingFacilities",
            "name": "Changing Facilities",
            "value": true
          },
          {
            "@type": "Showers",
            "name": "Showers",
            "value": true
          },
          {
            "@type": "Lockers",
            "name": "Lockers",
            "value": true
          },
          {
            "@type": "Towels",
            "name": "Towels",
            "value": false
          },
          {
            "@type": "Creche",
            "name": "Creche",
            "value": false
          },
          {
            "@type": "Parking",
            "name": "Parking",
            "value": false
          }
        ],
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": 51.7502,
          "longitude": -1.2674
        },
        "image": [
          {
            "@type": "ImageObject",
            "url": "https://upload.wikimedia.org/wikipedia/commons/e/e5/Oxford_StAldates_PostOffice.jpg"
          }
        ],
        "openingHoursSpecification": [
          {
            "@type": "OpeningHoursSpecification",
            "closes": "17:30",
            "dayOfWeek": [
              "https://schema.org/Sunday"
            ],
            "opens": "09:00"
          },
          {
            "@type": "OpeningHoursSpecification",
            "closes": "21:30",
            "dayOfWeek": [
              "https://schema.org/Monday"
            ],
            "opens": "06:30"
          },
          {
            "@type": "OpeningHoursSpecification",
            "closes": "21:30",
            "dayOfWeek": [
              "https://schema.org/Tuesday"
            ],
            "opens": "06:30"
          },
          {
            "@type": "OpeningHoursSpecification",
            "closes": "21:30",
            "dayOfWeek": [
              "https://schema.org/Wednesday"
            ],
            "opens": "06:30"
          },
          {
            "@type": "OpeningHoursSpecification",
            "closes": "21:30",
            "dayOfWeek": [
              "https://schema.org/Thursday"
            ],
            "opens": "06:30"
          },
          {
            "@type": "OpeningHoursSpecification",
            "closes": "21:30",
            "dayOfWeek": [
              "https://schema.org/Friday"
            ],
            "opens": "06:30"
          },
          {
            "@type": "OpeningHoursSpecification",
            "closes": "17:30",
            "dayOfWeek": [
              "https://schema.org/Saturday"
            ],
            "opens": "09:00"
          }
        ],
        "telephone": "01865 000001",
        "url": "https://en.wikipedia.org/wiki/Post_Office_Limited"
      },
      "offers": [
        {
          "@type": "Offer",
          "@id": "https://localhost:5001/api/identifiers/session-series/1125#/offers/0",
          "name": "Senior",
          "acceptedPaymentMethod": [
            "http://purl.org/goodrelations/v1#Cash",
            "http://purl.org/goodrelations/v1#PaymentMethodCreditCard"
          ],
          "ageRestriction": {
            "@type": "QuantitativeValue",
            "name": "Senior",
            "minValue": 60
          },
          "allowCustomerCancellationFullRefund": false,
          "latestCancellationBeforeStartDate": "P1D",
          "openBookingFlowRequirement": [
            "https://openactive.io/OpenBookingApproval",
            "https://openactive.io/OpenBookingNegotiation"
          ],
          "price": 6.28,
          "priceCurrency": "GBP"
        }
      ],
      "organizer": {
        "@type": "Organization",
        "@id": "https://localhost:5001/api/identifiers/sellers/2",
        "name": "Road Runner Bookcamp Ltd",
        "isOpenBookingAllowed": true,
        "sameAs": [
          "https://socialmedia.com/RoadRunnerBookcampLtd"
        ],
        "taxMode": "https://openactive.io/TaxNet",
        "telephone": "01698 111707",
        "termsOfService": [
          {
            "@type": "PrivacyPolicy",
            "name": "Privacy Policy",
            "requiresExplicitConsent": false,
            "url": "https://example.com/privacy.html"
          }
        ],
        "url": "https://brayan.net"
      },
      "url": "https://www.example.com/sessions/1125"
    },
    "duration": "PT5H7M",
    "maximumAttendeeCapacity": 2,
    "remainingAttendeeCapacity": 2
  }
}
</code></pre>
<h3 id="specs">Specs</h3>
<ul>
<li>‚úÖ should return 200 on success for request relevant to OrderItem 0</li>
</ul>
<h2 id="fetchopportunitiesvalidationofopportunityfeedextractfororderitem0">‚úÖ Fetch Opportunities &gt;&gt; validation of Opportunity Feed extract for OrderItem 0</h2>
<h3 id="specs-1">Specs</h3>
<ul>
<li>‚úÖ passes validation checks</li>
<li>‚úÖ matches the criteria 'TestOpportunityBookable' required for this test</li>
</ul>
<h3 id="validations">Validations</h3>
<ul>
<li>‚ö†Ô∏è $.eventStatus: Recommended property <code>eventStatus</code> is missing from <code>ScheduledSession</code>.</li>
<li>‚ö†Ô∏è $.leader: Recommended property <code>leader</code> is missing from <code>ScheduledSession</code>.</li>
<li>‚ö†Ô∏è $.url: Recommended property <code>url</code> is missing from <code>ScheduledSession</code>.</li>
<li>‚ö†Ô∏è $.superEvent.description: Recommended property <code>description</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.image: Recommended property <code>image</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.ageRange: Recommended property <code>ageRange</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.genderRestriction: Recommended property <code>genderRestriction</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.leader: Recommended property <code>leader</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.level: Recommended property <code>level</code> is missing from <code>SessionSeries</code>.</li>
<li>üìù $.genderRestriction: Data consumers will assume that there is no gender restriction when no valid <code>genderRestriction</code> is supplied on a <code>ScheduledSession</code>.</li>
<li>üìù $.ageRange: Data consumers will assume that the <code>ageRange</code> is 18+ when not specified.</li>
<li>üìù $.eventStatus: Data consumers will assume the <code>eventStatus</code> is scheduled if not specified or invalid.</li>
<li>üìù $.superEvent.genderRestriction: Data consumers will assume that there is no gender restriction when no valid <code>genderRestriction</code> is supplied on a <code>SessionSeries</code>.</li>
<li>üìù $.superEvent.ageRange: Data consumers will assume that the <code>ageRange</code> is 18+ when not specified.</li>
<li>üìù $.superEvent.eventStatus: Data consumers will assume the <code>eventStatus</code> is scheduled if not specified or invalid.</li>
<li>‚ùî $.superEvent.offers[0].ageRestriction.name: <code>schema:name</code> is declared in schema.org but this validator is not yet capable of checking whether they have the right format or values. You should refer to the schema.org documentation for <a href="https://schema.org/name" rel="noopener noreferrer" target="_blank">schema:name</a> for additional guidance.</li>
</ul>
<h2 id="c1">‚ùî C1</h2>
<h3 id="c1request">C1 Request</h3>
<p>PUT https://localhost:5001/api/openbooking/order-quote-templates/dc7a07d8-6b7d-4676-a65b-6eb03a53cad9</p>
<ul>
<li><strong>Content-Type:</strong> <code>"application/vnd.openactive.booking+json; version=1"</code></li>
<li><strong>Authorization:</strong> <code>"Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkIwNEY3QjkxREUzQjk0NzhDNjE4MzNGQjI0QUE1Q0RCIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE3NDQ4OTE0NzEsImV4cCI6MTc0NDg5NTA3MSwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMyIsImF1ZCI6Im9wZW5ib29raW5nIiwiY2xpZW50X2lkIjoiZGRkYzA4ZDMtOGM0MC00OGJjLWI0YjktNDVmZDMzMGUxYzZiIiwiaHR0cHM6Ly9vcGVuYWN0aXZlLmlvL2NsaWVudElkIjoiZGRkYzA4ZDMtOGM0MC00OGJjLWI0YjktNDVmZDMzMGUxYzZiIiwic3ViIjoiMTAwIiwiYXV0aF90aW1lIjoxNzQ0ODkxNDcxLCJpZHAiOiJsb2NhbCIsImh0dHBzOi8vb3BlbmFjdGl2ZS5pby9zZWxsZXJJZCI6Imh0dHBzOi8vbG9jYWxob3N0OjUwMDEvYXBpL2lkZW50aWZpZXJzL3NlbGxlcnMvMSIsImp0aSI6IjI3RjlDQkJBRDJGQjU2MTBCOUYxOTAyNUE0OUQ2RDlBIiwic2lkIjoiMUM5OTRDQUQzRUNGOTFDNUMyMDlFQURGREQ3RUIyMDMiLCJpYXQiOjE3NDQ4OTE0NzEsInNjb3BlIjpbIm9wZW5pZCIsIm9wZW5hY3RpdmUtb3BlbmJvb2tpbmciLCJvcGVuYWN0aXZlLWlkZW50aXR5Iiwib2ZmbGluZV9hY2Nlc3MiXSwiYW1yIjpbInB3ZCJdfQ.fEYu53J4oLtCgpKHxXbcGQeS0kGo7PzFZm5nk8nD2eZANay4vly7TPouFjWeuUU1bN6fnKR9Z5btivyyFjQ4s6D_k3ZZWXSCOaRhYMbd6wHwvyzpYgxXtuR_c8ALAwlnLrAb3zcNCer2HVM5bC5cCE_mS_xQxnjYx_qI9r8IzKZgbDVlhFJBND9IuTRmdbP99YNl16XM5GiHG8_Hh3oLM8l5tv3d6tI4en0xlWwL9jC2We-7yYXXLtIRenGGe4nG3jlf5mDT1gsIfzcSjxBpCtAQa7wlO03de9eGqcGdqEkOM9H9PO0oLnbbtUgyZy8P_3HNQWOwkRJgaVYB7kBuEw"</code></li>
</ul>
<pre><code class="json language-json">{
  "@context": "https://openactive.io/",
  "@type": "OrderQuote",
  "brokerRole": "https://openactive.io/AgentBroker",
  "broker": {
    "@type": "Organization",
    "name": "MyFitnessApp",
    "url": "https://myfitnessapp.example.com",
    "description": "A fitness app for all the community",
    "logo": {
      "@type": "ImageObject",
      "url": "http://data.myfitnessapp.org.uk/images/logo.png"
    },
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Alan Peacock Way",
      "addressLocality": "Village East",
      "addressRegion": "Middlesbrough",
      "postalCode": "TS4 3AE",
      "addressCountry": "GB"
    }
  },
  "seller": "https://localhost:5001/api/identifiers/sellers/2",
  "orderedItem": [
    {
      "@type": "OrderItem",
      "position": 0,
      "acceptedOffer": "https://localhost:5001/api/identifiers/session-series/1125#/offers/0",
      "orderedItem": "https://localhost:5001/api/identifiers/scheduled-sessions/1125/events/11250"
    }
  ],
  "payment": {
    "@type": "Payment",
    "name": "AcmeBroker Points",
    "accountId": "SN1593",
    "paymentProviderId": "STRIPE"
  }
}
</code></pre>
<hr />
<p>Response status code: 401 Unauthorized. Responded in 19.699893ms.</p>
<pre><code class="json language-json">{
  "@context": "https://openactive.io/",
  "@type": "InvalidAuthorizationDetailsError",
  "name": "The Broker supplied an invalid set of authorization details, either malformed or expired.",
  "statusCode": 401
}
</code></pre>
<h2 id="c1validationofc1">‚úÖ C1 &gt;&gt; validation of C1</h2>
<h3 id="specs-2">Specs</h3>
<ul>
<li>‚úÖ passes validation checks</li>
</ul>
<h3 id="validations-1">Validations</h3>
<ul>
<li>‚ö†Ô∏è $.description: Recommended property <code>description</code> is missing from <code>InvalidAuthorizationDetailsError</code>.</li>
<li>‚ö†Ô∏è $.instance: Recommended property <code>instance</code> is missing from <code>InvalidAuthorizationDetailsError</code>.</li>
</ul>
<h2 id="assertopportunitycapacityafterc1">‚úÖ Assert Opportunity Capacity (after C1)</h2>
<h3 id="specs-3">Specs</h3>
<ul>
<li>‚úÖ should return 200 on success for request relevant to OrderItem 0</li>
<li>‚úÖ should return a response containing <code>"@type": "InvalidAuthorizationDetailsError"</code> with status code <code>401</code></li>
</ul>
<h2 id="assertopportunitycapacityafterc1validationofopportunityfeedextractfororderitem0">‚úÖ Assert Opportunity Capacity (after C1) &gt;&gt; validation of Opportunity Feed extract for OrderItem 0</h2>
<h3 id="specs-4">Specs</h3>
<ul>
<li>‚úÖ passes validation checks</li>
</ul>
<h3 id="validations-2">Validations</h3>
<ul>
<li>‚ö†Ô∏è $.eventStatus: Recommended property <code>eventStatus</code> is missing from <code>ScheduledSession</code>.</li>
<li>‚ö†Ô∏è $.leader: Recommended property <code>leader</code> is missing from <code>ScheduledSession</code>.</li>
<li>‚ö†Ô∏è $.url: Recommended property <code>url</code> is missing from <code>ScheduledSession</code>.</li>
<li>‚ö†Ô∏è $.superEvent.description: Recommended property <code>description</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.image: Recommended property <code>image</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.ageRange: Recommended property <code>ageRange</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.genderRestriction: Recommended property <code>genderRestriction</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.leader: Recommended property <code>leader</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.level: Recommended property <code>level</code> is missing from <code>SessionSeries</code>.</li>
<li>üìù $.genderRestriction: Data consumers will assume that there is no gender restriction when no valid <code>genderRestriction</code> is supplied on a <code>ScheduledSession</code>.</li>
<li>üìù $.ageRange: Data consumers will assume that the <code>ageRange</code> is 18+ when not specified.</li>
<li>üìù $.eventStatus: Data consumers will assume the <code>eventStatus</code> is scheduled if not specified or invalid.</li>
<li>üìù $.superEvent.genderRestriction: Data consumers will assume that there is no gender restriction when no valid <code>genderRestriction</code> is supplied on a <code>SessionSeries</code>.</li>
<li>üìù $.superEvent.ageRange: Data consumers will assume that the <code>ageRange</code> is 18+ when not specified.</li>
<li>üìù $.superEvent.eventStatus: Data consumers will assume the <code>eventStatus</code> is scheduled if not specified or invalid.</li>
<li>‚ùî $.superEvent.offers[0].ageRestriction.name: <code>schema:name</code> is declared in schema.org but this validator is not yet capable of checking whether they have the right format or values. You should refer to the schema.org documentation for <a href="https://schema.org/name" rel="noopener noreferrer" target="_blank">schema:name</a> for additional guidance.</li>
</ul>
<h2 id="c2">‚ùî C2</h2>
<h3 id="c2request">C2 Request</h3>
<p>PUT https://localhost:5001/api/openbooking/order-quotes/dc7a07d8-6b7d-4676-a65b-6eb03a53cad9</p>
<ul>
<li><strong>Content-Type:</strong> <code>"application/vnd.openactive.booking+json; version=1"</code></li>
<li><strong>Authorization:</strong> <code>"Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkIwNEY3QjkxREUzQjk0NzhDNjE4MzNGQjI0QUE1Q0RCIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE3NDQ4OTE0NzEsImV4cCI6MTc0NDg5NTA3MSwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMyIsImF1ZCI6Im9wZW5ib29raW5nIiwiY2xpZW50X2lkIjoiZGRkYzA4ZDMtOGM0MC00OGJjLWI0YjktNDVmZDMzMGUxYzZiIiwiaHR0cHM6Ly9vcGVuYWN0aXZlLmlvL2NsaWVudElkIjoiZGRkYzA4ZDMtOGM0MC00OGJjLWI0YjktNDVmZDMzMGUxYzZiIiwic3ViIjoiMTAwIiwiYXV0aF90aW1lIjoxNzQ0ODkxNDcxLCJpZHAiOiJsb2NhbCIsImh0dHBzOi8vb3BlbmFjdGl2ZS5pby9zZWxsZXJJZCI6Imh0dHBzOi8vbG9jYWxob3N0OjUwMDEvYXBpL2lkZW50aWZpZXJzL3NlbGxlcnMvMSIsImp0aSI6IjI3RjlDQkJBRDJGQjU2MTBCOUYxOTAyNUE0OUQ2RDlBIiwic2lkIjoiMUM5OTRDQUQzRUNGOTFDNUMyMDlFQURGREQ3RUIyMDMiLCJpYXQiOjE3NDQ4OTE0NzEsInNjb3BlIjpbIm9wZW5pZCIsIm9wZW5hY3RpdmUtb3BlbmJvb2tpbmciLCJvcGVuYWN0aXZlLWlkZW50aXR5Iiwib2ZmbGluZV9hY2Nlc3MiXSwiYW1yIjpbInB3ZCJdfQ.fEYu53J4oLtCgpKHxXbcGQeS0kGo7PzFZm5nk8nD2eZANay4vly7TPouFjWeuUU1bN6fnKR9Z5btivyyFjQ4s6D_k3ZZWXSCOaRhYMbd6wHwvyzpYgxXtuR_c8ALAwlnLrAb3zcNCer2HVM5bC5cCE_mS_xQxnjYx_qI9r8IzKZgbDVlhFJBND9IuTRmdbP99YNl16XM5GiHG8_Hh3oLM8l5tv3d6tI4en0xlWwL9jC2We-7yYXXLtIRenGGe4nG3jlf5mDT1gsIfzcSjxBpCtAQa7wlO03de9eGqcGdqEkOM9H9PO0oLnbbtUgyZy8P_3HNQWOwkRJgaVYB7kBuEw"</code></li>
</ul>
<pre><code class="json language-json">{
  "@context": "https://openactive.io/",
  "@type": "OrderQuote",
  "brokerRole": "https://openactive.io/AgentBroker",
  "broker": {
    "@type": "Organization",
    "name": "MyFitnessApp",
    "url": "https://myfitnessapp.example.com",
    "description": "A fitness app for all the community",
    "logo": {
      "@type": "ImageObject",
      "url": "http://data.myfitnessapp.org.uk/images/logo.png"
    },
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Alan Peacock Way",
      "addressLocality": "Village East",
      "addressRegion": "Middlesbrough",
      "postalCode": "TS4 3AE",
      "addressCountry": "GB"
    }
  },
  "seller": "https://localhost:5001/api/identifiers/sellers/2",
  "customer": {
    "@type": "Person",
    "email": "Dina8@yahoo.com",
    "familyName": "Clinton",
    "identifier": "85ae7480-53ac-44a3-8a0d-9442be68811c"
  },
  "orderedItem": [
    {
      "@type": "OrderItem",
      "position": 0,
      "acceptedOffer": "https://localhost:5001/api/identifiers/session-series/1125#/offers/0",
      "orderedItem": "https://localhost:5001/api/identifiers/scheduled-sessions/1125/events/11250"
    }
  ],
  "payment": {
    "@type": "Payment",
    "name": "AcmeBroker Points",
    "accountId": "SN1593",
    "paymentProviderId": "STRIPE"
  }
}
</code></pre>
<hr />
<p>Response status code: 401 Unauthorized. Responded in 22.297656ms.</p>
<pre><code class="json language-json">{
  "@context": "https://openactive.io/",
  "@type": "InvalidAuthorizationDetailsError",
  "name": "The Broker supplied an invalid set of authorization details, either malformed or expired.",
  "statusCode": 401
}
</code></pre>
<h2 id="c2validationofc2">‚úÖ C2 &gt;&gt; validation of C2</h2>
<h3 id="specs-5">Specs</h3>
<ul>
<li>‚úÖ passes validation checks</li>
</ul>
<h3 id="validations-3">Validations</h3>
<ul>
<li>‚ö†Ô∏è $.description: Recommended property <code>description</code> is missing from <code>InvalidAuthorizationDetailsError</code>.</li>
<li>‚ö†Ô∏è $.instance: Recommended property <code>instance</code> is missing from <code>InvalidAuthorizationDetailsError</code>.</li>
</ul>
<h2 id="assertopportunitycapacityafterc2">‚úÖ Assert Opportunity Capacity (after C2)</h2>
<h3 id="specs-6">Specs</h3>
<ul>
<li>‚úÖ should return 200 on success for request relevant to OrderItem 0</li>
<li>‚úÖ should return a response containing <code>"@type": "InvalidAuthorizationDetailsError"</code> with status code <code>401</code></li>
</ul>
<h2 id="assertopportunitycapacityafterc2validationofopportunityfeedextractfororderitem0">‚úÖ Assert Opportunity Capacity (after C2) &gt;&gt; validation of Opportunity Feed extract for OrderItem 0</h2>
<h3 id="specs-7">Specs</h3>
<ul>
<li>‚úÖ passes validation checks</li>
</ul>
<h3 id="validations-4">Validations</h3>
<ul>
<li>‚ö†Ô∏è $.eventStatus: Recommended property <code>eventStatus</code> is missing from <code>ScheduledSession</code>.</li>
<li>‚ö†Ô∏è $.leader: Recommended property <code>leader</code> is missing from <code>ScheduledSession</code>.</li>
<li>‚ö†Ô∏è $.url: Recommended property <code>url</code> is missing from <code>ScheduledSession</code>.</li>
<li>‚ö†Ô∏è $.superEvent.description: Recommended property <code>description</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.image: Recommended property <code>image</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.ageRange: Recommended property <code>ageRange</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.genderRestriction: Recommended property <code>genderRestriction</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.leader: Recommended property <code>leader</code> is missing from <code>SessionSeries</code>.</li>
<li>‚ö†Ô∏è $.superEvent.level: Recommended property <code>level</code> is missing from <code>SessionSeries</code>.</li>
<li>üìù $.genderRestriction: Data consumers will assume that there is no gender restriction when no valid <code>genderRestriction</code> is supplied on a <code>ScheduledSession</code>.</li>
<li>üìù $.ageRange: Data consumers will assume that the <code>ageRange</code> is 18+ when not specified.</li>
<li>üìù $.eventStatus: Data consumers will assume the <code>eventStatus</code> is scheduled if not specified or invalid.</li>
<li>üìù $.superEvent.genderRestriction: Data consumers will assume that there is no gender restriction when no valid <code>genderRestriction</code> is supplied on a <code>SessionSeries</code>.</li>
<li>üìù $.superEvent.ageRange: Data consumers will assume that the <code>ageRange</code> is 18+ when not specified.</li>
<li>üìù $.superEvent.eventStatus: Data consumers will assume the <code>eventStatus</code> is scheduled if not specified or invalid.</li>
<li>‚ùî $.superEvent.offers[0].ageRestriction.name: <code>schema:name</code> is declared in schema.org but this validator is not yet capable of checking whether they have the right format or values. You should refer to the schema.org documentation for <a href="https://schema.org/name" rel="noopener noreferrer" target="_blank">schema:name</a> for additional guidance.</li>
</ul>
<h2 id="p">‚úÖ P</h2>
<h3 id="prequest">P Request</h3>
<p>PUT https://localhost:5001/api/openbooking/order-proposals/dc7a07d8-6b7d-4676-a65b-6eb03a53cad9</p>
<ul>
<li><strong>Content-Type:</strong> <code>"application/vnd.openactive.booking+json; version=1"</code></li>
<li><strong>Authorization:</strong> <code>"Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkIwNEY3QjkxREUzQjk0NzhDNjE4MzNGQjI0QUE1Q0RCIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE3NDQ4OTE0NzEsImV4cCI6MTc0NDg5NTA3MSwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMyIsImF1ZCI6Im9wZW5ib29raW5nIiwiY2xpZW50X2lkIjoiZGRkYzA4ZDMtOGM0MC00OGJjLWI0YjktNDVmZDMzMGUxYzZiIiwiaHR0cHM6Ly9vcGVuYWN0aXZlLmlvL2NsaWVudElkIjoiZGRkYzA4ZDMtOGM0MC00OGJjLWI0YjktNDVmZDMzMGUxYzZiIiwic3ViIjoiMTAwIiwiYXV0aF90aW1lIjoxNzQ0ODkxNDcxLCJpZHAiOiJsb2NhbCIsImh0dHBzOi8vb3BlbmFjdGl2ZS5pby9zZWxsZXJJZCI6Imh0dHBzOi8vbG9jYWxob3N0OjUwMDEvYXBpL2lkZW50aWZpZXJzL3NlbGxlcnMvMSIsImp0aSI6IjI3RjlDQkJBRDJGQjU2MTBCOUYxOTAyNUE0OUQ2RDlBIiwic2lkIjoiMUM5OTRDQUQzRUNGOTFDNUMyMDlFQURGREQ3RUIyMDMiLCJpYXQiOjE3NDQ4OTE0NzEsInNjb3BlIjpbIm9wZW5pZCIsIm9wZW5hY3RpdmUtb3BlbmJvb2tpbmciLCJvcGVuYWN0aXZlLWlkZW50aXR5Iiwib2ZmbGluZV9hY2Nlc3MiXSwiYW1yIjpbInB3ZCJdfQ.fEYu53J4oLtCgpKHxXbcGQeS0kGo7PzFZm5nk8nD2eZANay4vly7TPouFjWeuUU1bN6fnKR9Z5btivyyFjQ4s6D_k3ZZWXSCOaRhYMbd6wHwvyzpYgxXtuR_c8ALAwlnLrAb3zcNCer2HVM5bC5cCE_mS_xQxnjYx_qI9r8IzKZgbDVlhFJBND9IuTRmdbP99YNl16XM5GiHG8_Hh3oLM8l5tv3d6tI4en0xlWwL9jC2We-7yYXXLtIRenGGe4nG3jlf5mDT1gsIfzcSjxBpCtAQa7wlO03de9eGqcGdqEkOM9H9PO0oLnbbtUgyZy8P_3HNQWOwkRJgaVYB7kBuEw"</code></li>
</ul>
<pre><code class="json language-json">{
  "@context": "https://openactive.io/",
  "@type": "OrderProposal",
  "brokerRole": "https://openactive.io/AgentBroker",
  "broker": {
    "@type": "Organization",
    "name": "MyFitnessApp",
    "url": "https://myfitnessapp.example.com",
    "description": "A fitness app for all the community",
    "logo": {
      "@type": "ImageObject",
      "url": "http://data.myfitnessapp.org.uk/images/logo.png"
    },
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Alan Peacock Way",
      "addressLocality": "Village East",
      "addressRegion": "Middlesbrough",
      "postalCode": "TS4 3AE",
      "addressCountry": "GB"
    }
  },
  "seller": "https://localhost:5001/api/identifiers/sellers/2",
  "customer": {
    "@type": "Person",
    "email": "Dina8@yahoo.com",
    "familyName": "Clinton",
    "identifier": "85ae7480-53ac-44a3-8a0d-9442be68811c"
  },
  "orderedItem": [
    {
      "@type": "OrderItem",
      "position": 0,
      "acceptedOffer": "https://localhost:5001/api/identifiers/session-series/1125#/offers/0",
      "orderedItem": "https://localhost:5001/api/identifiers/scheduled-sessions/1125/events/11250"
    }
  ],
  "totalPaymentDue": {
    "@type": "PriceSpecification",
    "price": 0,
    "priceCurrency": "GBP"
  }
}
</code></pre>
<hr />
<p>Response status code: 401 Unauthorized. Responded in 21.409388ms.</p>
<pre><code class="json language-json">{
  "@context": "https://openactive.io/",
  "@type": "InvalidAuthorizationDetailsError",
  "name": "The Broker supplied an invalid set of authorization details, either malformed or expired.",
  "statusCode": 401
}
</code></pre>
<h3 id="specs-8">Specs</h3>
<ul>
<li>‚úÖ should return a response containing <code>"@type": "InvalidAuthorizationDetailsError"</code> with status code <code>401</code></li>
</ul>
<h2 id="pvalidationofp">‚úÖ P &gt;&gt; validation of P</h2>
<h3 id="specs-9">Specs</h3>
<ul>
<li>‚úÖ passes validation checks</li>
</ul>
<h3 id="validations-5">Validations</h3>
<ul>
<li>‚ö†Ô∏è $.description: Recommended property <code>description</code> is missing from <code>InvalidAuthorizationDetailsError</code>.</li>
<li>‚ö†Ô∏è $.instance: Recommended property <code>instance</code> is missing from <code>InvalidAuthorizationDetailsError</code>.</li>
</ul>
<script>
  function collapseH2Section(nextElement) {
    while(nextElement && nextElement.tagName !== 'H2') {
        if (nextElement.style.display !== 'none') {
            nextElement.style.display = 'none';
        }
        nextElement = nextElement.nextElementSibling;
    }
  }

  function showH2Section(nextElement) {
    while(nextElement && nextElement.tagName !== 'H2') {
        if (nextElement.style.display !== '') {
            nextElement.style.display = '';
        }
        nextElement = nextElement.nextElementSibling;
    }
  }

  function toggleH2Section(nextElement) {
    while(nextElement && nextElement.tagName !== 'H2') {
              // Toggle visibility
              nextElement.style.display = nextElement.style.display === 'none' ? '' : 'none';
              nextElement = nextElement.nextElementSibling;
          }
  }

  function collapseAllH2Sections() {
    var h2Elements = document.querySelectorAll('h2');
    h2Elements.forEach(function(h2) {
        var nextElement = h2.nextElementSibling;
        collapseH2Section(nextElement);
    });
  }
  function showAllH2Sections() {
    var h2Elements = document.querySelectorAll('h2');
    h2Elements.forEach(function(h2) {
        var nextElement = h2.nextElementSibling;
        showH2Section(nextElement);
    });
  }

  function collapseExceptFirstSpecialH2Section() {
    const h2Elements = document.querySelectorAll('h2');
    let specialSectionFound = false;

    h2Elements.forEach((h2) => {
        let nextNode = h2.nextElementSibling;
        let sectionContainsSpecialChar = false;

        // Iterate through sibling elements until the next H2 or no more siblings until the error section is found
        while (nextNode && nextNode.tagName !== 'H2') {
            if (!specialSectionFound && nextNode.textContent.includes('‚ùå')) {
                sectionContainsSpecialChar = true;
                specialSectionFound = true; 
                break;
              }
              showH2Section(nextNode);
            nextNode = nextNode.nextElementSibling;
        }

        // If this section is not the one with the error, collapse it
        if (!sectionContainsSpecialChar) {
            nextNode = h2.nextElementSibling; 
            collapseH2Section(nextNode);
        }
    });
}


  // Show/Hide each header section
  document.querySelectorAll('h2').forEach(function(h2) {
      h2.addEventListener('click', function() {
          let nextElement = this.nextElementSibling;
          toggleH2Section(nextElement)
      });
  });

  // Show all header sections
  document.getElementById('showH2Button').addEventListener('click', function() {
      showAllH2Sections();
  });

  // Collapse all header sections
  document.getElementById('collapseH2Button').addEventListener('click', function() {
      collapseAllH2Sections();
  });

  // Collapse all but first error section button
    document.getElementById('collapseAllButFirstError').addEventListener('click', function() {
      collapseExceptFirstSpecialH2Section();
  });

  // Hide all header sections by default
  collapseExceptFirstSpecialH2Section();
  </script>
<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css"></p>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</body>
</html>