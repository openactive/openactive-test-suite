<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
</head>
<body>
<p><head>
  </p>
<style>
h2 {
    cursor: pointer;
    border-top-color: #CCC;
    border-top-width: 1px;
    border-top-style: solid;
    padding-top: 5px;
}
h2:hover {
    color: #0056b3; /* Example color change on hover */
}
</style>
<p></head></p>
<p><a href="summary.html" rel="noopener noreferrer" target="_blank">< Return to Summary</a> | File Generated: Thu Apr 17 2025 12:27:47 GMT+0000 (Coordinated Universal Time)</p>
<p><button id="collapseH2Button">Collapse All Sections</button>
<button id="showH2Button">Show All Sections</button>
<button id="collapseAllButFirstError">Show Only First Error</button></p>
<h1 id="dynamicclientregistrationclientcredentialsflow">dynamic-client-registration &gt;&gt; client-credentials-flow</h1>
<p><strong>Booking Flow:</strong> </p>
<p><strong>Opportunity Type:</strong> </p>
<p><strong>Feature:</strong> Authentication / Dynamic Client Registration for Multiple Seller Systems (Implemented) </p>
<p><strong>Test:</strong>  Client Credentials Flow</p>
<p>Client Credentials Flow allows Booking Partners to access the Orders Feed</p>
<h3 id="runningonlythistest">Running only this test</h3>
<pre><code class="bash language-bash">npm start -- --runInBand test/features/authentication/dynamic-client-registration/implemented/client-credentials-flow-test.js
</code></pre>
<h3 id="isthistestfailing">Is this test failing?</h3>
<p>The <a href="https://openactive.io/openactive-test-suite/example-output/controlled/dynamic-client-registration_client-credentials-flow_undefined_undefined.html" rel="noopener noreferrer" target="_blank">OpenActive Reference Implementation test result for this test</a> can be used as a reference to help with debugging.</p>
<hr />
<p>✅ 4 passed with 0 failures, 0 warnings and 0 suggestions </p>
<hr />
<h2 id="openidconnectauthentication">✅ Open ID Connect Authentication</h2>
<h3 id="credentials">Credentials</h3>
<p>The test suite is using Dynamic Client Registration to retrieve credentials as part of this test, using the following configuration within <code>bookingPartnersForSpecificTests.dynamicSecondary.authentication</code>:</p>
<ul>
<li><strong>initialAccessToken</strong>: <code>dynamic-secondary-a21518cb57af7b6052df</code></li>
</ul>
<p>Hence the <code>client_id</code> and <code>client_secret</code> can be found within the Dynamic Client Registration response below.</p>
<h3 id="discoveryrequest">Discovery Request</h3>
<p>GET https://localhost:5003/.well-known/openid-configuration</p>
<ul>
<li><strong>accept:</strong> <code>"application/json"</code></li>
<li><strong>accept-encoding:</strong> <code>"gzip, deflate, br"</code></li>
<li><strong>host:</strong> <code>"localhost:5003"</code></li>
</ul>
<hr />
<p>Response status code: 200.</p>
<pre><code class="json language-json">{
  "issuer": "https://localhost:5003",
  "jwks_uri": "https://localhost:5003/.well-known/openid-configuration/jwks",
  "authorization_endpoint": "https://localhost:5003/connect/authorize",
  "token_endpoint": "https://localhost:5003/connect/token",
  "userinfo_endpoint": "https://localhost:5003/connect/userinfo",
  "end_session_endpoint": "https://localhost:5003/connect/endsession",
  "check_session_iframe": "https://localhost:5003/connect/checksession",
  "revocation_endpoint": "https://localhost:5003/connect/revocation",
  "introspection_endpoint": "https://localhost:5003/connect/introspect",
  "device_authorization_endpoint": "https://localhost:5003/connect/deviceauthorization",
  "frontchannel_logout_supported": true,
  "frontchannel_logout_session_supported": true,
  "backchannel_logout_supported": true,
  "backchannel_logout_session_supported": true,
  "scopes_supported": [
    "openid",
    "openactive-identity",
    "openactive-openbooking",
    "openactive-ordersfeed",
    "offline_access"
  ],
  "claims_supported": [
    "sub",
    "https://openactive.io/sellerId",
    "https://openactive.io/sellerName",
    "https://openactive.io/sellerUrl",
    "https://openactive.io/sellerLogo",
    "https://openactive.io/bookingServiceName",
    "https://openactive.io/bookingServiceUrl",
    "name",
    "https://openactive.io/clientId"
  ],
  "grant_types_supported": [
    "authorization_code",
    "client_credentials",
    "refresh_token",
    "implicit",
    "urn:ietf:params:oauth:grant-type:device_code"
  ],
  "response_types_supported": [
    "code",
    "token",
    "id_token",
    "id_token token",
    "code id_token",
    "code token",
    "code id_token token"
  ],
  "response_modes_supported": [
    "form_post",
    "query",
    "fragment"
  ],
  "token_endpoint_auth_methods_supported": [
    "client_secret_basic",
    "client_secret_post"
  ],
  "id_token_signing_alg_values_supported": [
    "RS256"
  ],
  "subject_types_supported": [
    "public"
  ],
  "code_challenge_methods_supported": [
    "plain",
    "S256"
  ],
  "request_parameter_supported": true,
  "registration_endpoint": "https://localhost:5003/connect/register"
}
</code></pre>
<h3 id="dynamicclientregistrationrequest">Dynamic Client Registration Request</h3>
<p>POST https://localhost:5003/connect/register</p>
<ul>
<li><strong>authorization:</strong> <code>"Bearer dynamic-secondary-a21518cb57af7b6052df"</code></li>
<li><strong>accept:</strong> <code>"application/json"</code></li>
<li><strong>content-type:</strong> <code>"application/json"</code></li>
<li><strong>content-length:</strong> <code>"413"</code></li>
<li><strong>accept-encoding:</strong> <code>"gzip, deflate, br"</code></li>
<li><strong>host:</strong> <code>"localhost:5003"</code></li>
</ul>
<pre><code class="json language-json">{
  "redirect_uris": [
    "http://localhost:3000/cb"
  ],
  "grant_types": [
    "authorization_code",
    "refresh_token",
    "client_credentials"
  ],
  "client_name": "OpenActive Test Suite Client",
  "client_uri": "https://github.com/openactive/openactive-test-suite",
  "logo_uri": "https://via.placeholder.com/512x256.png?text=Logo",
  "scope": "openid profile openactive-openbooking openactive-ordersfeed oauth-dymamic-client-update openactive-identity"
}
</code></pre>
<hr />
<p>Response status code: 201.</p>
<pre><code class="json language-json">{
  "client_id": "b271d445-8c3b-4d1b-928d-173f975d6150",
  "client_secret": "qj6o3C5d0g8DaCFjlJqqnsjvwi1OpZZ0AbxUQKwOmxa",
  "client_name": "OpenActive Test Suite Client",
  "client_uri": "https://github.com/openactive/openactive-test-suite",
  "initiate_login_uri": null,
  "logo_uri": "https://via.placeholder.com/512x256.png?text=Logo",
  "grant_types": [
    "authorization_code",
    "refresh_token",
    "client_credentials"
  ],
  "redirect_uris": [
    "http://localhost:3000/cb"
  ],
  "scope": "openid profile openactive-openbooking openactive-ordersfeed oauth-dymamic-client-update openactive-identity"
}
</code></pre>
<h3 id="clientcredentialsflowrequest">Client Credentials Flow Request</h3>
<p>POST https://localhost:5003/connect/token</p>
<ul>
<li><strong>authorization:</strong> <code>"Basic YjI3MWQ0NDUtOGMzYi00ZDFiLTkyOGQtMTczZjk3NWQ2MTUwOnFqNm8zQzVkMGc4RGFDRmpsSnFxbnNqdndpMU9wWlowQWJ4VVFLd09teGE="</code></li>
<li><strong>accept:</strong> <code>"application/json"</code></li>
<li><strong>content-type:</strong> <code>"application/x-www-form-urlencoded"</code></li>
<li><strong>content-length:</strong> <code>"57"</code></li>
<li><strong>accept-encoding:</strong> <code>"gzip, deflate, br"</code></li>
<li><strong>host:</strong> <code>"localhost:5003"</code></li>
</ul>
<pre><code class="json language-json">"grant_type=client_credentials&amp;scope=openactive-ordersfeed"
</code></pre>
<hr />
<p>Response status code: 200.</p>
<pre><code class="json language-json">{
  "access_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6IkIwNEY3QjkxREUzQjk0NzhDNjE4MzNGQjI0QUE1Q0RCIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE3NDQ4OTI4NjcsImV4cCI6MTc0NDg5NjQ2NywiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMyIsImF1ZCI6Im9wZW5ib29raW5nIiwiY2xpZW50X2lkIjoiYjI3MWQ0NDUtOGMzYi00ZDFiLTkyOGQtMTczZjk3NWQ2MTUwIiwiaHR0cHM6Ly9vcGVuYWN0aXZlLmlvL2NsaWVudElkIjoiYjI3MWQ0NDUtOGMzYi00ZDFiLTkyOGQtMTczZjk3NWQ2MTUwIiwianRpIjoiRjc5RDkyRjMxOTZBQzEwQTNBMzNEMUI5Njk4MTAwMjkiLCJpYXQiOjE3NDQ4OTI4NjcsInNjb3BlIjpbIm9wZW5hY3RpdmUtb3JkZXJzZmVlZCJdfQ.I0BJcaD9iBfkoAPWLie1iyQQ9JiM_w3CLQeejpt-OFQ9K5L9KVjZoaJnfwr1fdjLgXXL9wasdtWtfg7ibTMJvh4r8X1-qVeIhwX8rNDTOjkK7DbvfQD287ijfsGWnNbhP_m0QLwEsPt38QXgsrBE4q2TmTfZGjWzHw79TyOwHGi9FKgny7Kd0Yz-hX6SWZdpY1v8RRAAr71i4ituWxchIc0FLvfXnCJBqJwxWnfiXnGbeHQrDuIOZuyXJ8gIgveSppSOY4oaLkAIshsxon3ncWLPbC88iD9g7udJKSCmJdY3WaEWQtH9sExCFNPawqAyb-fpoc0TolQhJ0XzTXBYCA",
  "expires_in": 3600,
  "token_type": "Bearer",
  "scope": "openactive-ordersfeed"
}
</code></pre>
<h3 id="specs">Specs</h3>
<ul>
<li>✅ should complete Discovery successfully</li>
<li>✅ should complete Dynamic Client Registration successfully</li>
<li>✅ should complete Client Credentials Flow successfully</li>
</ul>
<script>
  function collapseH2Section(nextElement) {
    while(nextElement && nextElement.tagName !== 'H2') {
        if (nextElement.style.display !== 'none') {
            nextElement.style.display = 'none';
        }
        nextElement = nextElement.nextElementSibling;
    }
  }

  function showH2Section(nextElement) {
    while(nextElement && nextElement.tagName !== 'H2') {
        if (nextElement.style.display !== '') {
            nextElement.style.display = '';
        }
        nextElement = nextElement.nextElementSibling;
    }
  }

  function toggleH2Section(nextElement) {
    while(nextElement && nextElement.tagName !== 'H2') {
              // Toggle visibility
              nextElement.style.display = nextElement.style.display === 'none' ? '' : 'none';
              nextElement = nextElement.nextElementSibling;
          }
  }

  function collapseAllH2Sections() {
    var h2Elements = document.querySelectorAll('h2');
    h2Elements.forEach(function(h2) {
        var nextElement = h2.nextElementSibling;
        collapseH2Section(nextElement);
    });
  }
  function showAllH2Sections() {
    var h2Elements = document.querySelectorAll('h2');
    h2Elements.forEach(function(h2) {
        var nextElement = h2.nextElementSibling;
        showH2Section(nextElement);
    });
  }

  function collapseExceptFirstSpecialH2Section() {
    const h2Elements = document.querySelectorAll('h2');
    let specialSectionFound = false;

    h2Elements.forEach((h2) => {
        let nextNode = h2.nextElementSibling;
        let sectionContainsSpecialChar = false;

        // Iterate through sibling elements until the next H2 or no more siblings until the error section is found
        while (nextNode && nextNode.tagName !== 'H2') {
            if (!specialSectionFound && nextNode.textContent.includes('❌')) {
                sectionContainsSpecialChar = true;
                specialSectionFound = true; 
                break;
              }
              showH2Section(nextNode);
            nextNode = nextNode.nextElementSibling;
        }

        // If this section is not the one with the error, collapse it
        if (!sectionContainsSpecialChar) {
            nextNode = h2.nextElementSibling; 
            collapseH2Section(nextNode);
        }
    });
}


  // Show/Hide each header section
  document.querySelectorAll('h2').forEach(function(h2) {
      h2.addEventListener('click', function() {
          let nextElement = this.nextElementSibling;
          toggleH2Section(nextElement)
      });
  });

  // Show all header sections
  document.getElementById('showH2Button').addEventListener('click', function() {
      showAllH2Sections();
  });

  // Collapse all header sections
  document.getElementById('collapseH2Button').addEventListener('click', function() {
      collapseAllH2Sections();
  });

  // Collapse all but first error section button
    document.getElementById('collapseAllButFirstError').addEventListener('click', function() {
      collapseExceptFirstSpecialH2Section();
  });

  // Hide all header sections by default
  collapseExceptFirstSpecialH2Section();
  </script>
<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css"></p>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</body>
</html>